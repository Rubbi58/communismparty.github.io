<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Communism Party – Simple Move Test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      background: #000;
      color: #ffcc66;
      font-family: system-ui, sans-serif;
      overflow: hidden;
    }
    #hud {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 30px;
      background: #100408;
      color: #ffcc66;
      font-size: 12px;
      line-height: 30px;
      padding: 0 10px;
    }
    canvas {
      position: fixed;
      top: 30px;
      left: 0;
      width: 100vw;
      height: calc(100vh - 30px);
      display: block;
      background: #000;
    }
  </style>
</head>
<body>
  <div id="hud">
    TEST: Click anywhere, then use W A S D to move the white square. Last key will show here.
  </div>
  <canvas id="game"></canvas>

  <script>
    const hud = document.getElementById("hud");
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    function resize() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight - 30;
      draw();
    }
    window.addEventListener("resize", resize);
    resize();

    const TILE = 40;
    const MAP_W = 15;
    const MAP_H = 10;

    // 0 = wall, 1 = floor
    const map = [
      "000000000000000",
      "011111111111110",
      "011000001000010",
      "011000001000010",
      "011111111111110",
      "011000000000010",
      "011000011100010",
      "011000010000010",
      "011111111111110",
      "000000000000000"
    ];

    function isFloor(x,y){
      if (x<0||y<0||x>=MAP_W||y>=MAP_H) return false;
      return map[y][x] === "1";
    }

    const player = { x: 3.5, y: 5.5 };

    function draw() {
      ctx.clearRect(0,0,canvas.width,canvas.height);

      const camX = player.x*TILE - canvas.width/2;
      const camY = player.y*TILE - canvas.height/2;

      for (let y=0;y<MAP_H;y++){
        for (let x=0;x<MAP_W;x++){
          const sx = x*TILE - camX;
          const sy = y*TILE - camY;
          if (map[y][x]==="0") {
            ctx.fillStyle="#22080c"; // walls
          } else {
            ctx.fillStyle="#4a1517"; // floor
          }
          ctx.fillRect(sx,sy,TILE,TILE);
        }
      }

      // player
      ctx.fillStyle="#ffffff";
      ctx.fillRect(
        player.x*TILE - camX - 10,
        player.y*TILE - camY - 10,
        20,
        20
      );
    }

    draw(); // initial draw

    // Move on keydown, no game loop
    window.addEventListener("keydown", (e) => {
      hud.textContent = "Last key: " + e.key + "  –  use W A S D to move";

      let nx = player.x;
      let ny = player.y;

      if (e.key === "w" || e.key === "W") ny -= 0.5;
      if (e.key === "s" || e.key === "S") ny += 0.5;
      if (e.key === "a" || e.key === "A") nx -= 0.5;
      if (e.key === "d" || e.key === "D") nx += 0.5;

      if (isFloor(Math.floor(nx), Math.floor(ny))) {
        player.x = nx;
        player.y = ny;
        draw();
      }
    });
  </script>
</body>
</html>
